
# GWSDAT Graphical User Interface (GUI) {#GWSDATGUI}

The GWSDAT user interface is a web-based graphical user interface (GUI) which the user can interact with in many ways. The following sections will explain the interface in more detail.


## Data Input via Graphical User Interface {#DataInputviaGUI}

GWSDAT comes supplied with examples of groundwater monitoring data and these can be used to experiment with the tools for analysis and visualisation.  If you would like to do this you can move immediately to Section~X of this manual.  However, the aim of GWSDAT is of course to provide means of analysing user-supplied data and various options are supplied to allow this.  These options are all available from the *Manage Data* page which is the point of entry when GWSDAT is launched but can also be accessed at any time from the *Manage Data* item on the menu bar on the left hand side of the window.


```{r echo = FALSE}
    include_graphics("figures/data_manager.png", auto_pdf = FALSE)
```



A *Basic Example* and a *Comprehensive Example* are supplied but the buttons at the top of the page allow other data to be entered, in different forms.

```{r eho = FALSE}
tbl <- matrix(c("Restore Examples", "This allows the two in-built examples to be restored at any point, should this be needed.",
                "Load Data", "Use the *Browse* button to	loaded from a previous GWSDAT session.",
                "Add New Data", "This allows data to be entered manually into a spreadsheet (and saved for later use).",
                "Import .csv Data", "Use the *Browse* buttons to load separate 'Contaminant Data' and 'Well Coordinates' files, each in `.csv` form.  One or more shapefiles may also be loaded.",
                "Import Excel File", "Use the *Browse* button to load an Excel spreadsheet containing both 'Contaminant Data' and 'Well Coordinates'. One or more shapefiles may also be loaded."
                ), ncol = 2, byrow = TRUE)
kable(tbl) %>%
  column_spec(2, width = "30em")
```








```{r echo = FALSE}
tbl <- matrix(c("Import Excel File", "The file to be loaded should contain two spreadsheets labelled `Contaminant Data` and `Well Coordinates` and have the structure described above.  An example spreadsheet is available at *web address at gwsdat.net*.",
              "Import .csv Data", "The data can be exported from *Excel() into `.csv` format.  In this case there should be separate `.csv` files for the *Contaminant Data* and *Well Coordinates*.  Click on the *Browse* button to select these files.  For convenience, GWSDAT gives options for the *Column separator* and the *Quote for Character Strings* at the foot of this page. Click on the *Import|* button to read the data.",
              "Add New Data", "This creates blank spreadsheets with the required structure.  Entries can by typed in directly or copied and pasted from another source.  There is an *+Add Row* button and right clicking gives further options for adding and removing rows.",
              "Load Data", "This allows data which has previously been saved from GWSDAT to be loaded again."
              ), ncol = 2, byrow = TRUE)
kable(tbl) %>%
  column_spec(2, width = "30em")
```



<!-- \begin{tabular}{rm{0.7\textwidth}} -->
<!-- \cline{2-2} -->
<!-- \colorbox{NavyBlue}{\color{white} \textsf{Restore Examples}} & -->
<!-- This allows the two in-built examples to be restored at any point, should this be needed.  \\ -->
<!-- \cline{2-2} -->
<!-- \colorbox{NavyBlue}{\color{white} \textsf{Load Data}} & -->
<!-- Use the \textit{Browse} button to	loaded from a previous GWSDAT session. \\ -->
<!-- \cline{2-2} -->
<!-- \colorbox{NavyBlue}{\color{white} \textsf{Add New Data}} & -->
<!-- This allows data to be entered manually into a spreadsheet (and saved for later use).  \\ -->
<!-- \cline{2-2} -->
<!-- \colorbox{NavyBlue}{\color{white} \textsf{Import .csv Data}} & -->
<!-- Use the \textit{Browse} buttons to load separate 'Contaminant Data' and 'Well Coordinates' files, each in \texttt{.csv} form.  One or more shapefiles may also be loaded. \\ -->
<!-- \cline{2-2} -->
<!-- \colorbox{NavyBlue}{\color{white} \textsf{Import Excel File}} & -->
<!-- Use the \textit{Browse} button to load an Excel spreadsheet containing both 'Contaminant Data' and 'Well Coordinates. One or more shapefiles may also be loaded. \\ -->
<!-- \cline{2-2} -->
<!-- \end{tabular} -->

The details of data entry are described below but it is helpful first to describe the format of the data which is required.  The essential information is in are two spreadsheets - one which contains the contaminant data, and a second one which gives the co-ordinates of the wells.  There is also an option to use shape files to superimpose map information on spatial plots.

An example of the first spreadsheet is shown for the *Basic Example* in the screenshot below.  The full spreadsheet can be viewed by clicking the *Edit* button for the *Basic Example* in the *Manage Data* page of GWSDAT.  (When you wish to return to the *Manage Data* page, click the `back-arrow' button in the top left hand corner of the *Edit Data* page.)  The columns of the spreadsheet are explained in detail below.

\fbox{Wayne advises against the use of the term 'contaminant' but this is the terminology used in the software.}

<!-- \colorbox{NavyBlue}{\color{white} \textsf{Import Excel File}}  The file to be loaded should contain two spreadsheets labelled `Contaminant Data' and `Well Coordinates' and have the structure described above.  An example spreadsheet is available at \fbox{web address at gwsdat.net}. -->

<!-- \ -->

<!-- \noindent -->
<!-- \colorbox{NavyBlue}{\color{white} \textsf{Import .csv Data}}   The data can be exported from Excel into \texttt{.csv} format.  In this case there should be separate \texttt{.csv} files for the Contaminant Data and Well Coordinates.  Click on the `Browse' buttons to select these files.  For convenience, GWSDAT gives options for the `Column separator' and the `Quote for Character Strings' at the foot of this page. Click on the `Import' button to lead the data. -->

<!-- \ -->

<!-- \noindent -->
<!-- \colorbox{NavyBlue}{\color{white} \textsf{Add New Data}}  This creates blank spreadsheets with the required structure.  Entries can by typed in directly or copied and pasted from another source.  There is an \textit{+Add Row} button and right clicking gives further options for adding and removing rows. -->

<!-- \ -->

<!-- \noindent -->
<!-- \colorbox{NavyBlue}{\color{white} \textsf{Load Data}}  \fbox{Is this option available - I can't see a Save option?} -->






GWSDAT is designed to produce informative visualisations of groundwater monitoring over space and time.  To illustrate this, we will use the *Basic Example*.  If you are still in the detailed pages of the *Manage Data* section, click on the `back-arrow' in the top left hand corner to return to the main \textit{manage Data} page and then click on *Analyse* on the left had sidebar.  You will then be asked to specify which dataset you would like to analyse.  In addition to the standard examples, any other datasets you have created will be listed here too.  For the moment, click on the *Select* button for the *Basic Example'*.  You should now see a screen similar to the image below.

```{r, fig.cap = "GWSDAT Spatial Plot", label="GWSDATSpatialPlot",out.width = '100%', echo = FALSE}
include_graphics("figures/analysis-1.png")
```

The tabs at the top of this page give access to several different forms of analysis.  These are described in detail below.


## Spatial plot

The GWSDAT spatial plot (see Figure \@ref(fig:GWSDATSpatialPlot)) is for the analysis of spatial trends in solute concentrations, groundwater flow and, if present, NAPL thickness. It displays the locations of the monitoring wells (black solid dots) together with the well names and actual measured solute concentration values (detect data is displayed in a red font; non-detect in a black font). The date interval for the displayed data is indicated above the spatial plot. If a GIS shapefile has been supplied then the major site features (roads, tanks, etc) are overlaid on the spatial plot as light blue lines. 

A key feature of GWSDAT is the ability to produce estimates of contaminant concentrations over space and time simultaneously.  This gives a more effective method of analysis than the examination of concentration maps at isolated time points, or of time trends at isolated locations.  The simultaneous use of information over space and time allows estimates at particular locations and times to 'borrow strength' from neighbouring data.  Use the slider at the foot of the page to explore how the estimates of Benzene concentration change across the month of October.  Note that the slider box at the foot of the page can be moved to any convenient position by clicking and dragging with the mouse.  The 'Play' symbol (forward-arrow) in the bottom right hand corner of the slider activates a 'movie', which can be paused by pressing the button again.

### Settings 

The *Settings* tab located to the left hand side of the spatial plot gives control over many aspects of the display:

* **Aggregate by**: provides a drop-down menu which allows the temporal plotting resolution to be altered (Day, Month, Quarter, Year).  In the example in Figure \@ref(fig:GWSDATSpatialPlot), a monthly model output interval has been selected and the displayed actual solute concentration values were sampled between the 2nd Oct 2009 and the 1st Nov 2009. This functionality is identical to the 'Model Output Interval' detailed in Section \@ref(ExcelAddinMenuDataProcessingOptions). 

* **Substance**: Drop-down listbox to select the different solutes to be inspected.

* **Solute Conc. Unit**: allows the units to be changed between one of 'ng/l', 'ug/l' or 'mg/l'.

* **Plot Type**: Drop-down listbox with the following choices: 

    + **Conc-Terrain**: This option overlays the predictions of the spatiotemporal solute concentration smoother for a particular model output interval using a 'terrain' colour scheme - see example in Figure \@ref(fig:GWSDATSpatialPlot). Please note that the output of the spatiotemporal trend smoother is always given for the latest date in the displayed output interval. 
The dark green colours indicate low solute concentration and the colours are gradated through yellow and brown 
to almost white, to illustrate increasing estimated solute concentrations.The concentration values can be read off from the key on the right hand side of the plot. 
As the user iterates through time steps, it may be noticed that the area covered by the spatiotemporal solute concentration smoother changes. This is due to the fact that spatiotemporal predictions are only generated between interpolated data and are not extrapolated to regions where no data exists, which could potentially lead to erroneous results. For each time step, the area of the contour is calculated only from the collection of wells for which the monitoring period spans the current model output interval. GWSDAT generates predictions in the convex hull region dictated by these wells. The convex hull 
(see `http://en.wikipedia.org/wiki/Convex_hull`) may be visualised as the expected boundary if an elastic band was placed around the locations of these wells. 

    + **Conc-Topo**: This function is identical to Conc-Terrain but uses a topograghic colour scheme which gradates increasing solute concentrations through blue, green, yellow and beige.

    + **Conc-GreyScale**: This function is identical to Conc-Terrain but uses a grey scale colour scheme which gradates increasing solute concentrations through light grey to black. This is useful for printing on black and white printers!

    + **Conc-Terrain-Circles**: This selection overlays (terrain) colour coded circles located at the wells which have been 
monitored within the current model output interval. The size of the circles scales with the log of the observed solute concentration values and the solute concentration range can be read off from the colour key to the right of the plot. 

    + **Conc-Topo-Circles**:This selection is identical to Conc-Terrain-Circles but uses a topographic colour scheme.
    
    + **Conc-GreyScale-Circles**: This selection is identical to Conc-Terrain-Circles but uses a grey scale colour scheme. 

    + **NAPL-Circles**:  This selection displays the observed NAPL thicknesses within the current model output interval as 
size scaled and colour coded circles. NAPL thickness ranges are read off from the colour key on the right hand side of the plot. 
Colours are gradated from dark red through yellow to almost pure white to illustrate increasing NAPL thickness. 
The location of wells which have recorded NAPL in any part of their monitoring history are coloured with red solid dots instead of the usual black solid dots. 

\begin{center}
\setlength{\fboxrule}{1.5pt}
\fcolorbox{blue}{gray!10}{
\parbox{400pt}{{%\fontfamily{phv}\selectfont 
\textbf{Hint:} In the presence of poor well location network design or limited data then it is recommended the user select 
either the `Terrain-Circles' or `Topo-Circles' plot type. 
%This alternative, displays colour coded circles 
%located at the wells which have been monitored within the current time slice. The size of the circles scales 
%with the log of the observed solute concentration values. 
}
}
}
\end{center}





* **Plot Options**:


  + **Show Well Labels**: This controls whether to display well names/labels immediately below the well locations. 

  + **Scale colours to Data**: By default the colour key of solute concentrations is subdivided as shown in Figure \@ref(fig:GWSDATSpatialPlot). By using the same subdivisions the spatiotemporal solute concentration smoother plots can be directly compared between different model output intervals. This control will produce a new colour key whose subdivisions span the concentration predictions for the current model output interval only.

  + **Show Conc. Values**: This controls whether to display actual sampled concentration values immediately above the well locations. If the data is identified as a NAPL measurement the value will be displayed as 'NAPL' in a red font.

  + **Show GW Contour**: To add contour lines of groundwater level data. This superposes isobars of smoothed groundwater elevation data on top of the solute concentration plot. This is achieved through a 2D extension of the local linear regerssion method described in Appendix \@ref(smregressCalc). 

  + **Overlay Shapefiles**: This controls whether to overlay a site plan.

  + **Plume Diagnostics**: This controls whether to calculate and display plume diagnostic quantities from the predictions of the 
spatiotemporal solute concentration smoother (see Figure \@ref(fig:SpatialPlotwithPlumeDiagnostics)).The delineated plume is displayed with a solid red contour line which also includes a label displaying the plume boundary threshold value. The plume centre of mass is displayed with a red cross and the plume mass and area printed at the bottom left margin of the spatial plot. 
Note: in order for the correct plume diagnostics units to be used the *CoordUnits* field in the *Well Coordinates* table must be specified,  see Section \@ref(WellCoordinatesTable). More details about plume diagnostics can be found in Section \@ref(PlumeDiagnostics) and Appendix \@ref(AppendixPlumeDiagnostics).


* **Groundwater Flows**: The blue arrows in Figure \ref{fig:GWSDATContour} display the estimated direction and (relative) hydraulic gradient of groundwater flow at monitoring points across the a site. This is calculated from the combination of well coordinates and recorded groundwater elevations for this particular model output interval (see Appendix \@ref(GWCalc) for more details). This radiogroup allows the user to choose either 'not to display groundwater arrows' or 'direction only arrows' or 'both direction and relative strength arrows' (default).

\begin{center}
\setlength{\fboxrule}{1.5pt}
\fcolorbox{blue}{gray!10}{
\parbox{450pt}{{%\fontfamily{phv}\selectfont 
The spatiotemporal solute concentration smoother is a function which simultaneously estimates both the spatial and 
time series trend in site solute concentrations. By smoothing the data in both space and time 
it provides a clearer interpretation of site solute concentration dynamics than would otherwise be gleaned 
from the raw data. 
\uline{However, it is important to note that it is a smoother function and as such, the predictions 
do not necessarily lie on the observed data points}.
In the event that a sampled concentration value is significantly larger 
than the predictions of the spatiotemporal smoother, the well label is coloured red and surrounded by braces, 
e.g. \textcolor{red}{`$<$MW-1$>$'}. This serves as a very useful method for outlier detection. 
In addition, the analysis may be skewed if data are input from monitoring wells with disparate construction or 
screened in different aquifer systems.


Another important point to consider is that the quality of the spatiotemporal smoother is directly influenced 
by quality of the underlying data. In general, data originating from sites with many evenly spatially 
distributed wells with a long time history leads to better quality smoother predictions. 
The converse of a small number of wells or poor well location network design 
(e.g. wells located in almost a straight line), or short monitoring history, 
will lead to less reliable smoother predictions, particularly at the edges. 

In summary, the `spatiotemporal solute concentration smoother' plot is provided to 
help the user visualise the distribution of solutes and as an aid to risk-based decision-making.
However, for the reasons stated above, the predictions should be interpreted with care and 
a more detailed evaluation may be necessary to understand observed trends and outliers. 

Further methods for assessing the goodness of fit of the spatiotemporal smoother can be found in Section \ref{SectionSpatiotemporalDiagnostics}.
For more details on the spatiotemporal smoothing algorithm, please see Appendix \ref{SSCS}.
}
}
}
\end{center}

*Output formats + PPT* 
*movie*

## Time Series

```{r, fig.cap = "GWSDAT Time Series Plot", label="GWSDATTimeSeriesPlot",out.width = '100%', echo = FALSE}
include_graphics("figures/time-series-plot.png")
```


## Trends \& Thresholds

## Reporting

<!-- \label{sec:reporting} -->

In addition to providing visualisation of groundwater monitoring data, GWSDAT is also able to export displays in a variety of file formats, for inclusion in reports.  The map displays in the *Spatial Plot* tab of the *Analyse* section are used to illustrate this.  At the foot of the main map display there are three buttons.

* **Image format** provides a drop-down menu of the file type used when a spatial plot at a particular time point is created.  The available file types `png`, `jpg`, `pdf`, `ps` and `pptx`.

* **Save Plot** creates and downloads a file in the specified format.

* **Generate PPT Animation** creates a downloads a sequence of plots which display concentration maps across the whole time course.  Paging through these slides provides a very simple but effective means of animation.

